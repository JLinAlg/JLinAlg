<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
Syntax highlighting generated by Web C Plus Plus software v0.8.4
Webcpp Copyright (C)2001-2004 Jeffrey Bakker under the GNU GPL
Get webcpp at http://webcpp.sf.net
-->

<html>
<head>
<title>Function.java</title>
<link rel="stylesheet" type="text/css" href="jlinalg.css"/>
</head>
<body>

<div class="webcpp">
<pre>

<font CLASS=keyword>package</font> org.jlinalg.demo;

<font CLASS=keyword>import</font> java.util.Random;

<font CLASS=keyword>import</font> org.jlinalg.IRingElement;
<font CLASS=keyword>import</font> org.jlinalg.doublewrapper.DoubleWrapper;
<font CLASS=keyword>import</font> org.jlinalg.optimise.Target;

<font CLASS=comment>/**
 * A target for an optimisation: a 2-degree polynomial in the 3-d Space.
 * 
 * @author Georg Thimm
 */</font>
<font CLASS=keyword>public</font> <font CLASS=keyword>class</font> Function
		<font CLASS=keyword>implements</font> Target&lt;DoubleWrapper&gt;
{
	<font CLASS=comment>/**
	 * the number of variables
	 */</font>
	<font CLASS=keyword>final</font> <font CLASS=keytype>int</font> dim <font CLASS=symbols>=</font> <font CLASS=integer>3</font>;

	Random random <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> Random();

	<font CLASS=comment>/**
	 * the parameters of the function
	 */</font>
	<font CLASS=keyword>final</font> DoubleWrapper[] vector <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> DoubleWrapper[dim];

	<font CLASS=comment>/**
	 * the minimal parameters to be used.
	 */</font>
	<font CLASS=keyword>final</font> DoubleWrapper[] min <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> DoubleWrapper[dim];

	<font CLASS=comment>/**
	 * the maximal values for the parameters to be used.
	 */</font>
	<font CLASS=keyword>final</font> DoubleWrapper[] max <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> DoubleWrapper[dim];

	<font CLASS=comment>/**
	 * Create the target: set up the random initial parameters, {@link #min} and
	 * {@link #max}, as well as the coefficients for the polynomial.
	 */</font>
	<font CLASS=keyword>public</font> Function()
	{
		DoubleWrapper a <font CLASS=symbols>=</font> DoubleWrapper.FACTORY.get(<font CLASS=symbols>-</font><font CLASS=integer>10</font>);
		DoubleWrapper b <font CLASS=symbols>=</font> DoubleWrapper.FACTORY.get(<font CLASS=integer>10</font>);
		<font CLASS=comment>// a random vector</font>
		<font CLASS=keyword>for</font> (<font CLASS=keytype>int</font> i <font CLASS=symbols>=</font> <font CLASS=integer>0</font>; i &lt; vector.length; i<font CLASS=symbols>++</font>) {
			vector[i] <font CLASS=symbols>=</font> DoubleWrapper.FACTORY.randomValue(a, b);
			min[i] <font CLASS=symbols>=</font> a;
			max[i] <font CLASS=symbols>=</font> b;
			func[i] <font CLASS=symbols>=</font> DoubleWrapper.FACTORY.get(i <font CLASS=symbols>+</font> <font CLASS=integer>1</font>);
		}

	}

	<font CLASS=comment>/**
	 * @return the best values for the parameters. This is usually not known and
	 *         is here used for validation.
	 */</font>
	<font CLASS=keyword>public</font> DoubleWrapper[] best()
	{
		<font CLASS=keyword>return</font> func;
	}

	<font CLASS=comment>/**
	 * @see org.jlinalg.optimise.Target#getParameters()
	 */</font>
	@Override
	<font CLASS=keyword>public</font> DoubleWrapper[] getParameters()
	{
		<font CLASS=keyword>return</font> vector;
	}

	<font CLASS=comment>/**
	 * @see org.jlinalg.optimise.Target#getResidual()
	 */</font>
	@Override
	<font CLASS=keyword>public</font> DoubleWrapper getResidual()
	{
		<font CLASS=keyword>return</font> function(vector);
	}

	<font CLASS=comment>/**
	 * The function to be minimised
	 */</font>
	DoubleWrapper function(DoubleWrapper[] v)
	{
		DoubleWrapper sum <font CLASS=symbols>=</font> DoubleWrapper.FACTORY.zero();
		<font CLASS=keyword>for</font> (<font CLASS=keytype>int</font> i <font CLASS=symbols>=</font> <font CLASS=integer>0</font>; i &lt; v.length; i<font CLASS=symbols>++</font>) {
			DoubleWrapper r <font CLASS=symbols>=</font> v[i].subtract(func[i]);
			r <font CLASS=symbols>=</font> r.multiply(r);
			sum <font CLASS=symbols>=</font> sum.add(r);
		}
		<font CLASS=keyword>return</font> sum;
	}

	<font CLASS=comment>/**
	 * The parameters of the target function. The residual is zero if
	 * {@link #vector} is equal to this vector.
	 */</font>
	<font CLASS=keyword>final</font> DoubleWrapper[] func <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> DoubleWrapper[dim];

	<font CLASS=comment>/**
	 * @see org.jlinalg.optimise.Target#maxParameterValues()
	 */</font>
	@Override
	<font CLASS=keyword>public</font> DoubleWrapper[] maxParameterValues()
	{
		<font CLASS=keyword>return</font> max;
	}

	<font CLASS=comment>/**
	 * @see org.jlinalg.optimise.Target#minParameterValues()
	 */</font>
	@Override
	<font CLASS=keyword>public</font> DoubleWrapper[] minParameterValues()
	{
		<font CLASS=keyword>return</font> min;
	}

	<font CLASS=comment>/**
	 * @see org.jlinalg.optimise.Target#setParameters(org.jlinalg.IRingElement[])
	 */</font>
	@Override
	<font CLASS=keyword>public</font> <font CLASS=keytype>void</font> setParameters(IRingElement[] values)
	{
		System.arraycopy(values, <font CLASS=integer>0</font>, vector, <font CLASS=integer>0</font>, vector.length);
	}

	<font CLASS=comment>/**
	 * @return a textual representation of the function with {@link #vector}
	 *         filled in the parameters.
	 * @see java.lang.Object#toString()
	 */</font>
	@Override
	<font CLASS=keyword>public</font> String toString()
	{
		<font CLASS=keyword>return</font> <font CLASS=dblquot>"(x-"</font> <font CLASS=symbols>+</font> func[<font CLASS=integer>0</font>] <font CLASS=symbols>+</font> <font CLASS=dblquot>")^2+(y-"</font> + func[<font CLASS=integer>1</font>] + <font CLASS=dblquot>")^2+(c-"</font> <font CLASS=symbols>+</font> func[<font CLASS=integer>2</font>]
				<font CLASS=symbols>+</font> <font CLASS=dblquot>")^2"</font>;
	}

	<font CLASS=comment>/**
	 * assume the parameters are in range
	 * 
	 * @return always {@code true}
	 * @see org.jlinalg.optimise.Target#setParameter(int,
	 *      org.jlinalg.IRingElement)
	 */</font>
	@Override
	<font CLASS=keyword>public</font> <font CLASS=keytype>boolean</font> setParameter(<font CLASS=keytype>int</font> index, IRingElement value)
	{
		func[index] <font CLASS=symbols>=</font> (DoubleWrapper) value;
		<font CLASS=keyword>return</font> <font CLASS=keyword>true</font>;
	}

	<font CLASS=comment>/**
	 * the {@code index}'s optimised parameter
	 * 
	 * @see org.jlinalg.optimise.Target#getParameter(int)
	 */</font>
	@Override
	<font CLASS=keyword>public</font> DoubleWrapper getParameter(<font CLASS=keytype>int</font> index)
	{
		<font CLASS=keyword>return</font> func[index];
	}

}



</pre>

</div>


</body>
</html>
