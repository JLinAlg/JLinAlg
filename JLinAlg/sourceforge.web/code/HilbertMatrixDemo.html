<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<!--
Syntax highlighting generated by Web C Plus Plus software v0.8.4
Webcpp Copyright (C)2001-2004 Jeffrey Bakker under the GNU GPL
Get webcpp at http://webcpp.sf.net
-->

<html>
<head>
<title>../src/demo/java/org/jlinalg/demo/HilbertMatrixDemo.java</title>
<link rel="stylesheet" type="text/css" href="jlinalg.css"/>
</head>
<body>

<div class="webcpp">
<pre>

<font CLASS=comment>/*
 * This file is part of JLinAlg (&lt;http://jlinalg.sourceforge.net/&gt;).
 * 
 * JLinAlg is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as
 * published by the Free Software Foundation, either version 3 of
 * the License, or (at your option) any later version.
 * 
 * JLinAlg is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU Lesser General Public
 * License along with JLinALg. If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */</font>
<font CLASS=keyword>package</font> org.jlinalg.demo;

<font CLASS=keyword>import</font> org.jlinalg.FieldElement;
<font CLASS=keyword>import</font> org.jlinalg.IRingElementFactory;
<font CLASS=keyword>import</font> org.jlinalg.LinAlgFactory;
<font CLASS=keyword>import</font> org.jlinalg.LinSysSolver;
<font CLASS=keyword>import</font> org.jlinalg.Matrix;
<font CLASS=keyword>import</font> org.jlinalg.Vector;
<font CLASS=keyword>import</font> org.jlinalg.doublewrapper.DoubleWrapper;
<font CLASS=keyword>import</font> org.jlinalg.rational.Rational;

<font CLASS=comment>/**
 * This demo shows how the squared distance between the real solution of an
 * equation system to the one that is found when using floating point
 * arithmetic, grows exponentially when the dimension of the Hilbert matrix
 * increases.
 * 
 * @author Andreas Keilhauer
 */</font>
<font CLASS=keyword>public</font> <font CLASS=keyword>class</font> HilbertMatrixDemo
{

	<font CLASS=keyword>public</font> <font CLASS=keytype>static</font> <font CLASS=keytype>void</font> main(String[] argv)
	{
		<font CLASS=keyword>for</font> (<font CLASS=keytype>int</font> dimension <font CLASS=symbols>=</font> <font CLASS=integer>1</font>; dimension &lt;<font CLASS=symbols>=</font> <font CLASS=integer>50</font>; dimension++) {
			Matrix&lt;DoubleWrapper&gt; m <font CLASS=symbols>=</font> createHilbertMatrix(dimension,
					DoubleWrapper.FACTORY);
			LinAlgFactory&lt;DoubleWrapper&gt; factory <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> LinAlgFactory&lt;&gt;(
					m.getFactory());
			Vector&lt;DoubleWrapper&gt; solution <font CLASS=symbols>=</font> LinSysSolver.solve(m,
					factory.ones(dimension));

			Matrix&lt;Rational&gt; mExact <font CLASS=symbols>=</font> createHilbertMatrix(dimension,
					Rational.FACTORY);
			LinAlgFactory&lt;Rational&gt; factoryRational <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> LinAlgFactory&lt;&gt;(
					mExact.getFactory());
			Vector&lt;Rational&gt; solutionExact <font CLASS=symbols>=</font> LinSysSolver.solve(mExact,
					factoryRational.ones(dimension));

			System.out.println(<font CLASS=dblquot>"dimension = "</font>
					<font CLASS=symbols>+</font> dimension
					<font CLASS=symbols>+</font> <font CLASS=dblquot>" -&gt; error =  "</font>
					<font CLASS=symbols>+</font> solutionExact.squaredDistance(convert(solution))
							.doubleValue());
		}

	}

	<font CLASS=keyword>private</font> <font CLASS=keytype>static</font> &lt;RE <font CLASS=keyword>extends</font> FieldElement&lt;RE&gt;&gt; Matrix&lt;RE&gt; createHilbertMatrix(
			<font CLASS=keytype>int</font> dimension, IRingElementFactory&lt;RE&gt; factory)
	{
		Matrix&lt;RE&gt; hilbertMatrix <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> Matrix&lt;RE&gt;(dimension, dimension, factory);
		RE one <font CLASS=symbols>=</font> factory.one();
		<font CLASS=keyword>for</font> (<font CLASS=keytype>int</font> row <font CLASS=symbols>=</font> <font CLASS=integer>1</font>; row &lt;<font CLASS=symbols>=</font> hilbertMatrix.getRows(); row<font CLASS=symbols>++</font>) {
			RE rowNumber <font CLASS=symbols>=</font> factory.get(row);
			<font CLASS=keyword>for</font> (<font CLASS=keytype>int</font> col <font CLASS=symbols>=</font> <font CLASS=integer>1</font>; col &lt;<font CLASS=symbols>=</font> hilbertMatrix.getCols(); col<font CLASS=symbols>++</font>) {
				RE colNumber <font CLASS=symbols>=</font> factory.get(col);
				hilbertMatrix.set(row, col,
						one.divide(rowNumber.add(colNumber).subtract(one)));
			}
		}
		<font CLASS=keyword>return</font> hilbertMatrix;
	}

	<font CLASS=keyword>private</font> <font CLASS=keytype>static</font> Vector&lt;Rational&gt; convert(Vector&lt;DoubleWrapper&gt; vector)
	{
		Vector&lt;Rational&gt; converted <font CLASS=symbols>=</font> <font CLASS=keyword>new</font> Vector&lt;Rational&gt;(vector.length(),
				Rational.FACTORY);
		<font CLASS=keyword>for</font> (<font CLASS=keytype>int</font> i <font CLASS=symbols>=</font> <font CLASS=integer>1</font>; i &lt;<font CLASS=symbols>=</font> vector.length(); i++) {
			converted.set(i, Rational.FACTORY.get(vector.getEntry(i)));
		}
		<font CLASS=keyword>return</font> converted;

	}
}



</pre>

</div>


</body>
</html>
