<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=UTF-8">
<title>ArbitraryPrecisionDemo.java</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	color: #008000;
}
.sc3 {
	color: #008080;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
.sc18 {
	color: #008080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc16">package</span><span class="sc0"> </span><span class="sc11">org</span><span class="sc10">.</span><span class="sc11">jlinalg</span><span class="sc10">.</span><span class="sc11">demo</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">import</span><span class="sc0"> </span><span class="sc11">org</span><span class="sc10">.</span><span class="sc11">jlinalg</span><span class="sc10">.</span><span class="sc11">DivisionByZeroException</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">import</span><span class="sc0"> </span><span class="sc11">org</span><span class="sc10">.</span><span class="sc11">jlinalg</span><span class="sc10">.</span><span class="sc11">rational</span><span class="sc10">.</span><span class="sc11">Rational</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc3">/**
 * Example that shows how easily simple floating point arithmetic can go wrong.
 * Only with arbitrary precision your code will realize that you are dividing by
 * zero.
 * 
 * </span><span class="sc18">@author</span><span class="sc3"> Andreas Keilhauer
 */</span><span class="sc0">
</span><span class="sc16">public</span><span class="sc0"> </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">ArbitraryPrecisionDemo</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">private</span><span class="sc0"> </span><span class="sc16">final</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">String</span><span class="sc0"> </span><span class="sc11">INTERMEDIATE_CALCULATION_STR</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"(3 / 5000) * 5000"</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">private</span><span class="sc0"> </span><span class="sc16">final</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">String</span><span class="sc0"> </span><span class="sc11">FIRST_CALCULATION_STR</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"1 / ((3 / 5000) * 5000 + 3)"</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc3">/**
     * start the demonstration
     * 
     * </span><span class="sc18">@param</span><span class="sc3"> argv
     *            is ignored
     */</span><span class="sc0">
    </span><span class="sc16">public</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc11">String</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">demoFloat</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">demoDouble</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">demoArbitraryPrecision</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc16">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">demoFloat</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"============================================"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"Demo Float:"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">3.0f</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">5000.0f</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">5000.0f</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc11">INTERMEDIATE_CALCULATION_STR</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (only slightly wrong)"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc16">float</span><span class="sc0"> </span><span class="sc11">wrongResult</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0f</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">3.0f</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc11">FIRST_CALCULATION_STR</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">wrongResult</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (wrong) "</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"116 / 406 = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">116.0f</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">406.0f</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (not exact and bulky)"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc16">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">demoDouble</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"============================================"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"Demo Double: "</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc16">double</span><span class="sc0"> </span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">3.0</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">5000.0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">5000.0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc11">INTERMEDIATE_CALCULATION_STR</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (only slightly wrong)"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc16">double</span><span class="sc0"> </span><span class="sc11">wrongResult</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1.0</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">3.0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc11">FIRST_CALCULATION_STR</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">wrongResult</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (wrong)"</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"116 / 406 = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">116.0</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">406.0</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (not exact and bulky)"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc16">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">demoArbitraryPrecision</span><span class="sc10">()</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"============================================"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"Demo Rational with arbitrary precision:"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">Rational</span><span class="sc0"> </span><span class="sc11">one</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rational</span><span class="sc10">.</span><span class="sc11">FACTORY</span><span class="sc10">.</span><span class="sc11">get</span><span class="sc10">(</span><span class="sc4">1.0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">Rational</span><span class="sc0"> </span><span class="sc11">three</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rational</span><span class="sc10">.</span><span class="sc11">FACTORY</span><span class="sc10">.</span><span class="sc11">get</span><span class="sc10">(</span><span class="sc4">3.0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">Rational</span><span class="sc0"> </span><span class="sc11">fiveThousand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rational</span><span class="sc10">.</span><span class="sc11">FACTORY</span><span class="sc10">.</span><span class="sc11">get</span><span class="sc10">(</span><span class="sc4">5000.0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">Rational</span><span class="sc0"> </span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">three</span><span class="sc10">.</span><span class="sc11">divide</span><span class="sc10">(</span><span class="sc11">fiveThousand</span><span class="sc10">))</span><span class="sc0">
                </span><span class="sc10">.</span><span class="sc11">multiply</span><span class="sc10">(</span><span class="sc11">fiveThousand</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc11">INTERMEDIATE_CALCULATION_STR</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">intermediateResult</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (correct)"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">try</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc2">// This will throw a DivisionByZeroException
</span><span class="sc0">            </span><span class="sc11">one</span><span class="sc10">.</span><span class="sc11">divide</span><span class="sc10">(</span><span class="sc11">intermediateResult</span><span class="sc10">.</span><span class="sc11">subtract</span><span class="sc10">(</span><span class="sc11">three</span><span class="sc10">));</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">catch</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">DivisionByZeroException</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc11">FIRST_CALCULATION_STR</span><span class="sc0">
                    </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" =&gt; Division by zero detected. (correct)"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc11">Rational</span><span class="sc0"> </span><span class="sc11">oneHundredSixteen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rational</span><span class="sc10">.</span><span class="sc11">FACTORY</span><span class="sc10">.</span><span class="sc11">get</span><span class="sc10">(</span><span class="sc4">116</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">Rational</span><span class="sc0"> </span><span class="sc11">fourHundredSix</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rational</span><span class="sc10">.</span><span class="sc11">FACTORY</span><span class="sc10">.</span><span class="sc11">get</span><span class="sc10">(</span><span class="sc4">406</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">out</span><span class="sc10">.</span><span class="sc11">println</span><span class="sc10">(</span><span class="sc6">"116 / 406 = "</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">oneHundredSixteen</span><span class="sc10">.</span><span class="sc11">divide</span><span class="sc10">(</span><span class="sc11">fourHundredSix</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" (exact and concise solution)"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
